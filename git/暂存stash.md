
# 暂存stash

## 为什么我们需要它  

命令的场景：

此时我在 feature_666 分支,非常聚精会神加持高专注地实现一个功能 666 模块，简直键盘如飞的编写代码～～～   
然后这时，客户反馈出一个 bug , 非常严重，必须立马解决，优先级为 0 ！！！   
于是，我需要去到 release 分支去 checkout 新的分支去工作了，但是 666 功能还没完成怎么办？   
此时我面临着一个选择题：   

* A：提交后切换，代码保存到分支 feature_666，却产生一个无意义的提交   
* B：不提交直接切换，然而这个选项根本没人会选。

是不是很难选，此时，别忘记还有 C 选项！

* C：使用 git stash , 将当前修改(未提交的代码)存入缓存区，切换分支修改 bug ,回来再通过 git stash pop 取出来。

## 入门

```
git stash //将修改存储到暂存区，工作区会删除这些修改
```
```
git checkout <bug_branch>  
```
### 查看修改

如果你有丢失代码的经历，肯定会对这个之前没接触的新命令不放心，那么怎么确定你操作成功了呢？
```
git stash  show  //查看刚才暂存的修改
```
### 取出修改

现在 bug 改完了，要重新回来开发了，取出修改
```
git checkout <feture_branch> //切换刚才功能开发的分支
```
```
git stash pop //取出修改
```

### 修改存储到什么位置了?

当我们使用 `git init`给项目添加版本控制的时候，会在项目路径下生成一个 `.git` 隐藏文件夹。`.git` 中存储着版本管理的所有信息。`.git/refs/stash`中，存储的是最后一个 stash 对应的节点指针

同样，在`.git/log/refs/stash`中可以看到我们全部的 stash 记录信息

### 存储多个 stash 的情况

_ok ,我们来尝试一下修改文件，然后再次使用`git stash`,此时我们有个两个 暂存修改，那么怎么查看呢？_
```
git stash list //查看暂存区的所有暂存修改记录
```
如果在未提交的情况下，执行`git stash`两次，无法准确分辨两个stash 具体修改的是哪些内容。在这种情况下，给｀stash｀存储的修改起个名字，显然非常重要，方式如下：
```
git stash save <message>  
```
### 取出也有好几种方式
上面的演示中，取出 stash 的方式都是
```
git stash pop  //取出最近一次暂存并删除记录列表中对应记录  
```
这是一个非常好用的取出方式，一般使用的频率最高，但并非适用所有情况。

因为`git stash pop`是弹出栈顶的一个`stash`，也就是最后一次存储的`stash`。在存储多个`stash`，想取出非栈顶的一个的情况下，是不适用的。

这个时候要使用：
```
git stash list //查看暂存区的所有暂存修改  
git stash apply stash@{X} //取出相应的暂存  
git stash drop stash@{X} //将记录列表中取出的对应暂存记录删除
```

## 案例：基于`Visual Studio Code`

* U：vscode看到状态为U代表：Untracked files【未被跟踪的文件】

这个时候需要把文件添加到git版本控制中：
```
git add *
```

* A：vscode看到状态为A代表：文件已被跟踪，已被添加到git版本控制中

* 接下来我们来暂存

```
git stash save 202008220940
```


